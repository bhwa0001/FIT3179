{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 450,
  "title": "Forest Area Change by Country (1990-2020)",
  "projection": {"type": "equalEarth"},
  "layer": [
    {
      "data": {"sphere": true},
      "mark": {"type": "geoshape", "fill":"aliceblue"}
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/bhwa0001/FIT3179/main/ne_110m.json",
        "format": {"type": "topojson", "feature": "ne_110m_graticules_30"}
      },
      "mark": {"type": "geoshape", "fill": null, "stroke": "lightgray", "strokeWidth": 0.5}
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/bhwa0001/FIT3179/main/ne_110m.json",
        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
      },
      "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white", "strokeWidth": 0.5}
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/bhwa0001/FIT3179/main/deforestation-rates-by-country-2025.csv"
      },
      "transform": [
        {
          "filter": "datum['Forest Area Absolute Change 1990-2020'] != null && datum['Forest Area Absolute Change 1990-2020'] != 0"
        },
        {
          "calculate": "abs(datum['Forest Area Absolute Change 1990-2020'])",
          "as": "Absolute Change"
        }
      ],
      "mark": {
        "type": "circle",
        "tooltip": {"content": "data"},
        "opacity": 0.8,
        "stroke": "black",
        "strokeWidth": 1
      },
      "encoding": {
        "longitude": {"field": "Longitude", "type": "quantitative"},
        "latitude": {"field": "Latitude", "type": "quantitative"},
        "size": {
          "field": "Absolute Change",
          "type": "quantitative",
          "title": "Absolute Forest Change (1k ha)",
          "scale": {
            "type": "sqrt",
            "range": [10, 1000]
          },
          "legend": {
            "format": ".0f",
            "values": [1000, 10000, 50000, 100000]
          }
        },
        "color": {
          "field": "Forest Area Absolute Change 1990-2020",
          "type": "quantitative",
          "title": "Net Forest Change (1k ha)",
          "scale": {
            "type": "linear",
            "scheme": "redyellowgreen",
            "domainMid": 0,
            "reverse": false
          },
          "legend": {
            "format": ".0f"
          }
        },
        "tooltip": [
          {"field": "country", "type": "nominal", "title": "Country"},
          {"field": "Forest Area Absolute Change 1990-2020", "type": "quantitative", "title": "Net Forest Change (1k ha)", "format": ".0f"}
        ]
      }
    },
      {
        "data": {
          "values": [
            {"longitude": -30, "latitude": -10, "text": "Brazil: -92,000k ha", "fontSize": 10, "fontWeight": "bold"},
            {"longitude": 130, "latitude": 20, "text": "China: +63,000k ha", "fontSize": 10, "fontWeight": "bold"},
            {"longitude": 110, "latitude": -40, "text": "Australia: +100k ha", "fontSize": 10, "fontWeight": "bold"}
          ]
        },
        "mark": {
          "type": "text",
          "align": "center",
          "baseline": "middle",
          "fill": "black",
          "opacity": 0.9
        },
        "encoding": {
          "longitude": {"field": "longitude", "type": "quantitative"},
          "latitude": {"field": "latitude", "type": "quantitative"},
          "text": {"field": "text", "type": "nominal"}
        }
      }
  ]
}